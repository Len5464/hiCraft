<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      http-equiv="X-UA-Compatible"
      content="IE=edge"
    />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0"
    />
    <title>hiCraft | 搜尋好設計、好點子</title>
    <link
      rel="icon"
      type="image/svg+xml"
      href="/favicon.svg"
    />
  </head>
  <body>
    <%- include('./modules/navbar'); -%>
    <header class="bg-home-header d-flex flex-column">
      <div class="container my-auto">
        <h1 class="title-display">搜尋好設計、好點子</h1>
        <%- include('./modules/search-bar'); -%>
      </div>
      <picture>
        <source
          srcset="../assets/images/triangle-mobile.svg"
          media="(max-width: 480px)"
        />
        <img
          class="w-100"
          src="../assets/images/triangle.svg"
        />
      </picture>
    </header>
    <!-- 節日 -->
    <section class="pt-20 pb-30 position-relative">
      <svg
        class="position-absolute top-n50px start-50px d-none d-md-block"
        width="182"
        height="226"
        viewBox="0 0 182 226"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <circle
          cx="91"
          cy="135"
          r="90.5"
          stroke="#D5C0AE"
        />
        <circle
          cx="91"
          cy="135"
          r="77.5"
          stroke="#D5C0AE"
        />
        <circle
          cx="91"
          cy="135"
          r="64.5"
          stroke="#D5C0AE"
        />
        <circle
          cx="91"
          cy="135"
          r="51.5"
          stroke="#D5C0AE"
        />
        <circle
          cx="91"
          cy="135"
          r="38.5"
          stroke="#D5C0AE"
        />
        <circle
          cx="91"
          cy="135"
          r="25.5"
          stroke="#D5C0AE"
        />
        <circle
          cx="91"
          cy="135"
          r="12.5"
          stroke="#D5C0AE"
        />
        <circle
          cx="57"
          cy="43"
          r="43"
          fill="#D5C0AE"
        />
      </svg>
      <div class="container">
        <div class="d-flex justify-content-between align-items-center">
          <h2 class="z-1 mb-8">歡慶節日</h2>
        </div>
        <div class="row gy-6">
          <div class="col-md-4">
            <a
              href="search-result.html?query=父親節"
              class="festival-card festival-card-fathers-day"
            >
              <h3 class="festival-card-title">父親節</h3>
              <time class="festival-card-date">08/08</time>
            </a>
          </div>
          <div class="col-md-4">
            <a
              href="search-result.html?query=中秋節"
              class="festival-card festival-card-mid-autumn"
            >
              <h3 class="festival-card-title">中秋節</h3>
              <time class="festival-card-date">09/29</time>
            </a>
          </div>
          <div class="col-md-4">
            <a
              href="search-result.html?query=聖誕節"
              class="festival-card festival-card-xmas"
            >
              <h3 class="festival-card-title">聖誕節</h3>
              <time class="festival-card-date">12/25</time>
            </a>
          </div>
        </div>
      </div>
    </section>
    <!-- 主題 -->
    <section class="py-30 bg-black-20 position-relative">
      <svg
        class="position-absolute top-n50px end-50px d-none d-md-block"
        width="182"
        height="226"
        viewBox="0 0 182 226"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <circle
          cx="91"
          cy="135"
          r="90.5"
          stroke="#D5C0AE"
        />
        <circle
          cx="91"
          cy="135"
          r="77.5"
          stroke="#D5C0AE"
        />
        <circle
          cx="91"
          cy="135"
          r="64.5"
          stroke="#D5C0AE"
        />
        <circle
          cx="91"
          cy="135"
          r="51.5"
          stroke="#D5C0AE"
        />
        <circle
          cx="91"
          cy="135"
          r="38.5"
          stroke="#D5C0AE"
        />
        <circle
          cx="91"
          cy="135"
          r="25.5"
          stroke="#D5C0AE"
        />
        <circle
          cx="91"
          cy="135"
          r="12.5"
          stroke="#D5C0AE"
        />
        <circle
          cx="57"
          cy="43"
          r="43"
          fill="#D5C0AE"
        />
      </svg>
      <div class="container">
        <ul
          class="nav nav-tabs row g-0 nav-topic"
          id="homeTab"
          role="tablist"
        >
          <li
            class="nav-item col-6 col-lg-3 z-1"
            role="presentation"
          >
            <button
              class="nav-link w-100 active"
              id="topicTab"
              data-bs-toggle="tab"
              data-bs-target="#topicList"
              type="button"
              role="tab"
              aria-controls="topicList"
              aria-selected="true"
            >
              熱門主題
            </button>
          </li>
          <li
            class="nav-item col-6 col-lg-3 z-1"
            role="presentation"
          >
            <button
              class="nav-link w-100"
              id="interestTab"
              data-bs-toggle="tab"
              data-bs-target="#interestList"
              type="button"
              role="tab"
              aria-controls="interestList"
              aria-selected="false"
            >
              關注主題
            </button>
          </li>
        </ul>
        <div
          id="homeTabContent"
          class="tab-content"
        >
          <div
            class="tab-pane bg-primary p-6 fade show active"
            id="topicList"
            role="tabpanel"
            aria-labelledby="topicList-tab"
            tabindex="0"
          >
            <ul class="list-inline mb-0 row row-cols-1 row-cols-md-2 row-cols-xl-3 gy-6">
              <% for (let i = 0 ; i < 6; i++){ %>
              <li class="col">
                <% const item = tagGroups?.hot[i] %>
                <a
                  href="search-result.html?query=<%= item %>"
                  class="topic-card"
                >
                  <img
                    src="../assets/images/topic/<%= i+1 %>.jpg"
                    alt="主題示意圖"
                    class="topic-card-img"
                  />
                  <div class="topic-card-body">
                    <h4 class="topic-card-title"><%= tagsI18n[item]["zh-TW"] %></h4>
                    <small class="topic-card-sub-title"><%= item %></small>
                  </div>
                </a>
              </li>
              <% } %>
            </ul>
          </div>
          <div
            id="interestList"
            class="tab-pane bg-primary p-6 fade"
            role="tabpanel"
            aria-labelledby="interest-tab"
            tabindex="0"
          >
            <ul class="list-inline mb-0 row row-cols-1 row-cols-md-2 row-cols-xl-3 gy-6">
              <% for (let i = 0 ; i < 6; i++){ %>
              <li class="col">
                <a
                  href="search-result.html?query=<%= interests[i] %>"
                  class="topic-card"
                >
                  <img
                    src="../assets/images/topic/<%= i+1 %>.jpg"
                    alt="主題示意圖"
                    class="topic-card-img"
                  />
                  <div class="topic-card-body">
                    <h4 class="topic-card-title"><%= tagsI18n[interests[i]]["zh-TW"] %></h4>
                    <small class="topic-card-sub-title"><%= interests[i] %></small>
                  </div>
                </a>
              </li>
              <% } %>
            </ul>
          </div>
        </div>
      </div>
    </section>

    <!-- 精選 -->
    <section class="bg-white-brick py-30">
      <div class="container position-relative">
        <div class="d-flex justify-content-center align-items-center gap-2">
          <h2 class="m-0">精選作品</h2>
          <img
            src="../assets/images/hiCraft_logo-light.svg"
            alt="hiCraft"
          />
        </div>
        <ul
          id="gallery-choice"
          class="gallery mt-16"
        ></ul>
        <a
          id="load-gallery-choice"
          href=""
          class="btn btn-primary-white btn-lg mt-16 mx-auto d-block"
          >載入更多
        </a>
      </div>
    </section>
    <%- include('./modules/footer'); -%>
    <!--  -->
    <%- include('./modules/loading-mask'); -%>
    <script
      type="module"
      src="../main.js"
    ></script>
    <script type="module">
      import { debounce } from "/assets/js/utils.js";
      import Gallery from "/assets/js/Gallery.js";
      window.addEventListener("load", async () => {
        const res = await fetch("/data/crafts.json").catch((error) => {
          throw new Error("HTTP error! status: " + error.status);
        });

        const data = await res.json().catch((error) => {
          throw new Error("Failed to fetch crafts data");
        });

        const imgURLs = data.filter((craft) => craft.tags.includes("Featured")).map((craft) => craft.imgURLs[0]);
        const loadBtn = document.querySelector("#load-gallery-choice");
        const gallery = new Gallery("#gallery-choice", {
          imgURLs: imgURLs,
          loadButton: loadBtn,
          loadAmount: 8,
        });

        window.addEventListener(
          "resize",
          debounce(
            () => gallery.container.querySelectorAll(".gallery-item").forEach((item) => gallery.resizeItem(item)),
            100
          )
        );
      });
    </script>
  </body>
</html>
